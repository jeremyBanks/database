# x/database/sql for Deno, Version 0.2

**Date:** March _dd_, 2021

**Status:** incomplete and blocked by [./v0.1](./v0.1.md) and
[#3](https://github.com/jeremyBanks/database/pull/3).

## Goals

Safe and convenient dynamic query composition with <code>SQL\`â€¦\`</code>
strings for users of `x/database/sql/sql.ts`. Originally proposed in-part at
[dyedgreen/deno-sqlite#104](https://github.com/dyedgreen/deno-sqlite/pull/104).

## SQL Strings (`x/database/sql/string.ts`) ðŸ†•

That's the stuff.

## Database Driver API (`x/database/sql/driver.ts`)

- `driver.Query<Value>` interface ðŸ†•
  - `.sql: readonly string`
  - `.args?: readonly Array<Value>`
  - This is a new interface for types that can provide the SQL string and
    optional bound values when executing a query with a driver. The associated
    `Value` type (which will typically be inferred) must be compatible with the
    `Value` type expected by the driver.
  - `./strings.ts` provides the only included implementation, but others are
    supported.

## Database Consumer API (`x/database/sql/sql.ts`)

- `sql.Transaction` class
  - `.query[Sync](query: driver.Query): AsyncIterable<Iterable<Value>>` ðŸ†•
  - `.queryRow[Sync](query: driver.Query): Promise<Array<Value>>` ðŸ†•
  - `.exec[Sync](query: driver.Query): {â€¦}` ðŸ†•
  - The above existing methods all gain a new alternative argument overload to
    accept the query and bound values as a single `driver.Query` argument
    instead of as two separate arguments.
